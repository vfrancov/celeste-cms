<content-component [title]="'Configuraci贸n'">
  <div class="d-flex justify-content-between mb-2">
    <p>Gestiona los permisos de tus usuarios</p>
  </div>
  <div class="row">
    <div class="col">
      <data-table [title]="'Configuraci贸n de Usuarios'" [pages]="amountOfPages" [rows]="amountOfRows" (emitPage)="selectedPage($event)">
        <data-filter [filterFields]="dataTableHead" (emitFilter)="applyFilter($event)" (emitRestore)="restoreFilter($event)"></data-filter>
        <thead>
          <ng-container *ngFor="let thead of dataTableHead | keyvalue">
            <th class="pointer" (click)="sort(thead.value.field)" aria-sort="ascending">
              {{thead.value.title}}
              <i class="fa fa-sort mr-1" *ngIf="thead.value.isSort"></i>
              <i class="fa fa-arrow-{{(isDescOrAsc) ? 'down' : 'up'}}" *ngIf="thead.value.isSort"></i>
            </th>
          </ng-container>
        </thead>
        <tbody>
          <tr>
            <td [attr.colspan]="dataTableHead.length" class="text-center" *ngIf="userData?.length === 0">No hay registros</td>
          </tr>
          <ng-container *ngFor="let user of userData">
            <tr>
              <td>{{user.username}}</td>
              <td>{{user.roleName}}</td>
              <td>
                <span class="badge badge-info mr-1">Crear</span>
                <span class="badge badge-info mr-1">Editar</span>
                <span class="badge badge-info">Eliminar</span>
              </td>
              <td>
                <div class="btn-group">
                  <button *ngIf="userPermissions.update" class="btn btn-info btn-sm btn-small" data-bs-toggle="modal"
                    data-bs-target="#modalDefineConfig" (click)="showUpConfigModal(user)"><i class="fa fa-edit"></i></button>
                  <button class="btn btn-primary btn-sm btn-small"><i class="fa fa-cog"></i></button>
                </div>
              </td>
          </ng-container>
        </tbody>
      </data-table>
    </div>
  </div>
  <modal-component #modalConfiguration [idModal]="'modalDefineConfig'" [modalTitle]="'Configuraci贸n de Permisos'" [modalLarge]="true">
    <div class="row">
      <div class="col">
        <h5 class="no-margin">Registra tus permisos</h5>
        <small>Define la configuracion de los servicios por cada usuario</small>
        <alert-message [error]="errorConfiguration"></alert-message>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-6">
        <h3>Modulos</h3>
        <hr>
        <div class="row">
          <div class="col-6" *ngFor="let module of modules">
            <div class="custom-control custom-checkbox small">
              <input type="checkbox" class="custom-control-input" id="{{module.id}}" (click)="setUserModule(module)">
              <label class="custom-control-label" for="{{module.id}}">{{module.prop}}</label>
            </div>
          </div>
        </div>
      </div>
      <div class="col-6">
        <h3>Permisos</h3>
        <hr>
        <div class="form-group" *ngFor="let permission of permissions">
          <div class="custom-control custom-checkbox small">
            <input type="checkbox" class="custom-control-input" id="{{permission.name}}" (click)="setUserPermissions(permission)">
            <label class="custom-control-label" for="{{permission.name}}">{{permission.name}}</label>
          </div>
        </div>
        <button class="btn btn-primary" (click)="saveMenuAndUserPermissions()">Guardar Configuraci贸n</button>
      </div>
    </div>
  </modal-component>
</content-component>
